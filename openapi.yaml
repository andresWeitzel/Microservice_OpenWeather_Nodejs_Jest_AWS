openapi: 3.0.3
info:
  title: OpenWeather Microservice API
  description: |
    A comprehensive microservice for weather data retrieval and forecasting.
    This API provides real-time weather information, forecasts, and city data
    with enhanced features like caching, validation, and professional error handling.
    
    ## Features
    - Real-time weather data
    - 5-day weather forecasts
    - City information and search
    - Enhanced data with additional metrics
    - Caching and performance optimization
    - Input validation and sanitization
    
    ## Authentication
    This API requires an API key for all requests. Include your API key in the
    `X-API-Key` header or as a query parameter.
    
    ## Rate Limiting
    - 1000 requests per hour per API key
    - 100 requests per minute per IP address
    
    ## Error Handling
    All errors follow a consistent format with appropriate HTTP status codes
    and detailed error messages.
  version: 1.0.0
  contact:
    name: API Support
    email: support@openweather-microservice.com
    url: https://github.com/your-org/openweather-microservice
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT
  termsOfService: https://your-domain.com/terms

servers:
  - url: http://localhost:4000/dev/v1
    description: Development server (serverless-offline)

security:
  - ApiKeyAuth: []
  - BearerAuth: []

paths:
  # Health Check
  /health:
    get:
      tags:
        - System
      summary: Health Check
      description: Check the health status of the microservice
      operationId: healthCheck
      security: []
      responses:
        '200':
          description: Service is healthy
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HealthResponse'
        '500':
          description: Service is unhealthy
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  # Weather Endpoints
  /weather/id/{cityId}:
    get:
      tags:
        - Weather
      summary: Get current weather by city ID
      description: Retrieve current weather information for a specific city
      operationId: getWeatherById
      parameters:
        - name: cityId
          in: path
          required: true
          description: OpenWeatherMap city ID
          schema:
            type: integer
            minimum: 1
            example: 2643743
        - name: units
          in: query
          description: Temperature units
          schema:
            type: string
            enum: [metric, imperial, kelvin]
            default: metric
        - name: lang
          in: query
          description: Language for weather descriptions
          schema:
            type: string
            enum: [en, es, fr, de, it, pt, ru, zh, ja, ko]
            default: en
      responses:
        '200':
          description: Current weather data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WeatherResponse'
        '400':
          description: Invalid city ID
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Invalid API key
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: City not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '429':
          description: Rate limit exceeded
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /weather/coordinates/{lat}/{lon}:
    get:
      tags:
        - Weather
      summary: Get current weather by coordinates
      description: Retrieve current weather information using latitude and longitude
      operationId: getWeatherByCoordinates
      parameters:
        - name: lat
          in: path
          required: true
          description: Latitude coordinate (-90 to 90)
          schema:
            type: number
            format: float
            minimum: -90
            maximum: 90
            example: -34.6132
        - name: lon
          in: path
          required: true
          description: Longitude coordinate (-180 to 180)
          schema:
            type: number
            format: float
            minimum: -180
            maximum: 180
            example: -58.3772
      responses:
        '200':
          description: Current weather data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WeatherResponse'
              examples:
                buenos_aires_coordinates:
                  summary: Buenos Aires coordinates weather data
                  value:
                    location:
                      name: "Buenos Aires"
                      country: "AR"
                      coordinates:
                        lat: -34.6132
                        lon: -58.3772
                    current:
                      temperature: 28.5
                      feels_like: 30.1
                      humidity: 72
                      pressure: 1010
                      description: "Partly cloudy"
                      icon: "02d"
                    timestamp: "2024-01-15T10:30:00Z"
                    source: "OpenWeatherMap"
                london_coordinates:
                  summary: London coordinates weather data
                  value:
                    location:
                      name: "London"
                      country: "GB"
                      coordinates:
                        lat: 51.5074
                        lon: -0.1278
                    current:
                      temperature: 15.2
                      feels_like: 14.8
                      humidity: 65
                      pressure: 1013
                      description: "Cloudy"
                      icon: "04d"
                    timestamp: "2024-01-15T10:30:00Z"
                    source: "OpenWeatherMap"
                new_york_coordinates:
                  summary: New York coordinates weather data
                  value:
                    location:
                      name: "New York"
                      country: "US"
                      coordinates:
                        lat: 40.7128
                        lon: -74.0060
                    current:
                      temperature: 22.3
                      feels_like: 24.1
                      humidity: 68
                      pressure: 1015
                      description: "Clear sky"
                      icon: "01d"
                    timestamp: "2024-01-15T10:30:00Z"
                    source: "OpenWeatherMap"
                tokyo_coordinates:
                  summary: Tokyo coordinates weather data
                  value:
                    location:
                      name: "Tokyo"
                      country: "JP"
                      coordinates:
                        lat: 35.6762
                        lon: 139.6503
                    current:
                      temperature: 18.7
                      feels_like: 19.2
                      humidity: 75
                      pressure: 1008
                      description: "Light rain"
                      icon: "10d"
                    timestamp: "2024-01-15T10:30:00Z"
                    source: "OpenWeatherMap"
        '400':
          description: Invalid coordinates
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                invalid_coordinates:
                  summary: Invalid coordinates
                  value:
                    message: "Both latitude and longitude parameters are required"
        '401':
          description: Invalid API key
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '429':
          description: Rate limit exceeded
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /weather/location/{location}:
    get:
      tags:
        - Weather
      summary: Get current weather by location
      description: Retrieve current weather information using city name
      operationId: getWeatherByLocation
      parameters:
        - name: location
          in: path
          required: true
          description: City name (e.g., "London", "Buenos Aires", "New York")
          schema:
            type: string
            minLength: 2
            maxLength: 100
            example: "London"
      responses:
        '200':
          description: Current weather data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WeatherResponse'
              examples:
                london_weather:
                  summary: London weather data
                  value:
                    location:
                      name: "London"
                      country: "GB"
                      coordinates:
                        lat: 51.5074
                        lon: -0.1278
                    current:
                      temperature: 15.2
                      feels_like: 14.8
                      humidity: 65
                      pressure: 1013
                      description: "Cloudy"
                      icon: "04d"
                    timestamp: "2024-01-15T10:30:00Z"
                    source: "OpenWeatherMap"
                buenos_aires_weather:
                  summary: Buenos Aires weather data
                  value:
                    location:
                      name: "Buenos Aires"
                      country: "AR"
                      coordinates:
                        lat: -34.6132
                        lon: -58.3772
                    current:
                      temperature: 28.5
                      feels_like: 30.1
                      humidity: 72
                      pressure: 1010
                      description: "Partly cloudy"
                      icon: "02d"
                    timestamp: "2024-01-15T10:30:00Z"
                    source: "OpenWeatherMap"
        '400':
          description: Invalid location format
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                invalid_location:
                  summary: Invalid location parameter
                  value:
                    message: "Location parameter is required"
        '401':
          description: Invalid API key
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Location not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '429':
          description: Rate limit exceeded
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /weather/zipcode/{zipcode}/{countryCode}:
    get:
      tags:
        - Weather
      summary: Get current weather by zipcode
      description: Retrieve current weather information using zipcode and country code
      operationId: getWeatherByZipcode
      parameters:
        - name: zipcode
          in: path
          required: true
          description: Zipcode
          schema:
            type: string
            pattern: '^[A-Za-z0-9\s\-\.\,]+$'
            example: "10001"
        - name: countryCode
          in: path
          required: true
          description: Country code (ISO 3166-1 alpha-2)
          schema:
            type: string
            pattern: '^[A-Z]{2}$'
            example: "US"
      responses:
        '200':
          description: Current weather data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WeatherResponse'
              examples:
                new_york_zipcode:
                  summary: New York weather data by zipcode
                  value:
                    location:
                      name: "New York"
                      country: "US"
                      coordinates:
                        lat: 40.7128
                        lon: -74.0060
                    current:
                      temperature: 22.3
                      feels_like: 24.1
                      humidity: 68
                      pressure: 1015
                      description: "Clear sky"
                      icon: "01d"
                    timestamp: "2024-01-15T10:30:00Z"
                    source: "OpenWeatherMap"
                buenos_aires_zipcode:
                  summary: Buenos Aires weather data by zipcode
                  value:
                    location:
                      name: "Buenos Aires"
                      country: "AR"
                      coordinates:
                        lat: -34.6132
                        lon: -58.3772
                    current:
                      temperature: 28.5
                      feels_like: 30.1
                      humidity: 72
                      pressure: 1010
                      description: "Partly cloudy"
                      icon: "02d"
                    timestamp: "2024-01-15T10:30:00Z"
                    source: "OpenWeatherMap"
        '400':
          description: Invalid zipcode or country code
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                invalid_zipcode:
                  summary: Invalid zipcode format
                  value:
                    message: "Invalid zipcode format. Please provide a valid zipcode (2-20 characters, letters, numbers, spaces, hyphens, dots, and commas allowed)"
                missing_country_code:
                  summary: Missing country code
                  value:
                    message: "Country code parameter is required"
        '401':
          description: Invalid API key
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Zipcode not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '429':
          description: Rate limit exceeded
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /weather/units/{location}/{units}:
    get:
      tags:
        - Weather
      summary: Get current weather with specific units
      description: Retrieve current weather information with temperature units (metric, imperial, kelvin)
      operationId: getWeatherWithUnits
      parameters:
        - name: location
          in: path
          required: true
          description: City name (e.g., "London", "Buenos Aires", "New York")
          schema:
            type: string
            minLength: 2
            maxLength: 100
            example: "London"
        - name: units
          in: path
          required: true
          description: Temperature units
          schema:
            type: string
            enum: [metric, imperial, kelvin]
            example: "metric"
      responses:
        '200':
          description: Current weather data with specific units
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WeatherResponse'
              examples:
                london_metric:
                  summary: London weather data in metric units
                  value:
                    location:
                      name: "London"
                      country: "GB"
                      coordinates:
                        lat: 51.5074
                        lon: -0.1278
                    current:
                      temperature: 15.2
                      feels_like: 14.8
                      humidity: 65
                      pressure: 1013
                      description: "Cloudy"
                      icon: "04d"
                    timestamp: "2024-01-15T10:30:00Z"
                    source: "OpenWeatherMap"
                buenos_aires_imperial:
                  summary: Buenos Aires weather data in imperial units
                  value:
                    location:
                      name: "Buenos Aires"
                      country: "AR"
                      coordinates:
                        lat: -34.6132
                        lon: -58.3772
                    current:
                      temperature: 83.3
                      feels_like: 86.2
                      humidity: 72
                      pressure: 1010
                      description: "Partly cloudy"
                      icon: "02d"
                    timestamp: "2024-01-15T10:30:00Z"
                    source: "OpenWeatherMap"
        '400':
          description: Invalid location or units parameter
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                invalid_location:
                  summary: Invalid location parameter
                  value:
                    message: "Location parameter is required"
                invalid_units:
                  summary: Invalid units parameter
                  value:
                    message: "Invalid units parameter. Must be one of: metric, imperial, kelvin"
        '401':
          description: Invalid API key
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Location not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '429':
          description: Rate limit exceeded
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /weather/language/{location}/{language}:
    get:
      tags:
        - Weather
      summary: Get current weather with specific language
      description: Retrieve current weather information with descriptions in specific language
      operationId: getWeatherWithLanguage
      parameters:
        - name: location
          in: path
          required: true
          description: City name (e.g., "London", "São Paulo", "Madrid")
          schema:
            type: string
            minLength: 2
            maxLength: 100
            example: "São Paulo"
        - name: language
          in: path
          required: true
          description: Language code for weather descriptions
          schema:
            type: string
            enum: [en, es, fr, de, it, pt, ru, ja, ko, zh_cn, zh_tw, ar, hi, th, tr, vi]
            example: "pt"
      responses:
        '200':
          description: Current weather data with specific language
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WeatherResponse'
              examples:
                sao_paulo_portuguese:
                  summary: São Paulo weather data in Portuguese
                  value:
                    location:
                      name: "São Paulo"
                      country: "BR"
                      coordinates:
                        lat: -23.5505
                        lon: -46.6333
                    current:
                      temperature: 25.8
                      feels_like: 27.2
                      humidity: 68
                      pressure: 1012
                      description: "Parcialmente nublado"
                      icon: "02d"
                    timestamp: "2024-01-15T10:30:00Z"
                    source: "OpenWeatherMap"
                madrid_spanish:
                  summary: Madrid weather data in Spanish
                  value:
                    location:
                      name: "Madrid"
                      country: "ES"
                      coordinates:
                        lat: 40.4168
                        lon: -3.7038
                    current:
                      temperature: 18.5
                      feels_like: 17.8
                      humidity: 55
                      pressure: 1020
                      description: "Despejado"
                      icon: "01d"
                    timestamp: "2024-01-15T10:30:00Z"
                    source: "OpenWeatherMap"
        '400':
          description: Invalid location or language parameter
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                invalid_location:
                  summary: Invalid location parameter
                  value:
                    message: "Location parameter is required"
                invalid_language:
                  summary: Invalid language parameter
                  value:
                    message: "Invalid language parameter. Must be one of: en, es, fr, de, it, pt, ru, ja, ko, zh_cn, zh_tw, ar, hi, th, tr, vi"
        '401':
          description: Invalid API key
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Location not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '429':
          description: Rate limit exceeded
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /weather/combined/{location}/{units}/{language}:
    get:
      tags:
        - Weather
      summary: Get current weather with all parameters combined
      description: Retrieve current weather information with specific units and language
      operationId: getWeatherByCombined
      parameters:
        - name: location
          in: path
          required: true
          description: City name (e.g., "Buenos Aires", "London", "Tokyo")
          schema:
            type: string
            minLength: 2
            maxLength: 100
            example: "Buenos Aires"
        - name: units
          in: path
          required: true
          description: Temperature units
          schema:
            type: string
            enum: [metric, imperial, kelvin]
            example: "Kelvin"
        - name: language
          in: path
          required: true
          description: Language code for weather descriptions
          schema:
            type: string
            enum: [en, es, fr, de, it, pt, ru, ja, ko, zh_cn, zh_tw, ar, hi, th, tr, vi]
            example: "fr"
      responses:
        '200':
          description: Current weather data with specific units and language
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WeatherResponse'
              examples:
                buenos_aires_kelvin_french:
                  summary: Buenos Aires weather data in Kelvin with French descriptions
                  value:
                    location:
                      name: "Buenos Aires"
                      country: "AR"
                      coordinates:
                        lat: -34.6132
                        lon: -58.3772
                    current:
                      temperature: 301.5
                      feels_like: 303.1
                      humidity: 72
                      pressure: 1010
                      description: "Partiellement nuageux"
                      icon: "02d"
                    timestamp: "2024-01-15T10:30:00Z"
                    source: "OpenWeatherMap"
                tokyo_metric_spanish:
                  summary: Tokyo weather data in metric units with Spanish descriptions
                  value:
                    location:
                      name: "Tokyo"
                      country: "JP"
                      coordinates:
                        lat: 35.6762
                        lon: 139.6503
                    current:
                      temperature: 18.7
                      feels_like: 19.2
                      humidity: 75
                      pressure: 1008
                      description: "Lluvia ligera"
                      icon: "10d"
                    timestamp: "2024-01-15T10:30:00Z"
                    source: "OpenWeatherMap"
        '400':
          description: Invalid parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                invalid_location:
                  summary: Invalid location parameter
                  value:
                    message: "Location parameter is required"
                invalid_units:
                  summary: Invalid units parameter
                  value:
                    message: "Invalid units parameter. Must be one of: metric, imperial, kelvin"
                invalid_language:
                  summary: Invalid language parameter
                  value:
                    message: "Invalid language parameter. Must be one of: en, es, fr, de, it, pt, ru, ja, ko, zh_cn, zh_tw, ar, hi, th, tr, vi"
        '401':
          description: Invalid API key
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Location not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '429':
          description: Rate limit exceeded
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  # Forecast Endpoints
  /forecast/days/{days}:
    get:
      tags:
        - Forecast
      summary: Get weather forecast by days
      description: Retrieve weather forecast for a specific number of days
      operationId: getForecastByDays
      parameters:
        - name: days
          in: path
          required: true
          description: Number of forecast days (1-5)
          schema:
            type: integer
            minimum: 1
            maximum: 5
            example: 5
        - name: q
          in: query
          required: true
          description: City name and country code (e.g., "London,GB")
          schema:
            type: string
            pattern: '^[a-zA-Z\s]+,[A-Z]{2}$'
            example: "London,GB"
        - name: units
          in: query
          description: Temperature units
          schema:
            type: string
            enum: [metric, imperial, kelvin]
            default: metric
        - name: lang
          in: query
          description: Language for weather descriptions
          schema:
            type: string
            enum: [en, es, fr, de, it, pt, ru, zh, ja, ko]
            default: en
      responses:
        '200':
          description: Weather forecast data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForecastResponse'
        '400':
          description: Invalid parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Invalid API key
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Location not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '429':
          description: Rate limit exceeded
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  # City IDs Endpoints
  /cities/{cityName}:
    get:
      tags:
        - Information
      summary: Get city IDs by name
      description: Find city IDs by name from local database
      operationId: getCityIdsByName
      parameters:
        - name: cityName
          in: path
          required: true
          description: City name to search for
          schema:
            type: string
            minLength: 2
            maxLength: 100
            example: "Buenos Aires"
      responses:
        '200':
          description: City IDs found successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CityIdsResponse'
              examples:
                buenos_aires:
                  summary: Buenos Aires search
                  value:
                    searchQuery: "Buenos Aires"
                    countryCode: ""
                    limit: 5
                    totalResults: 1
                    cities:
                      - id: 3435910
                        name: "Buenos Aires"
                        state: "Buenos Aires"
                        country: "AR"
                        coordinates: ""
                        displayName: "Buenos Aires, Buenos Aires, AR"
                    source: "local_database"
                    databaseInfo:
                      description: "Local database of OpenWeather city IDs organized by city name and country"
                      version: "1.0.0"
                      lastUpdated: "2024-01-15"
                      totalCities: 150
                      source: "OpenWeather Geocoding API"
        '400':
          description: Invalid city name parameter
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                invalid_city:
                  summary: Invalid city name
                  value:
                    message: "City name parameter is required"
        '401':
          description: Invalid API key
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '429':
          description: Rate limit exceeded
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /cities/{cityName}/{countryCode}:
    get:
      tags:
        - Information
      summary: Get city IDs by name and country
      description: Find city IDs by name and country code from local database
      operationId: getCityIdsByNameAndCountry
      parameters:
        - name: cityName
          in: path
          required: true
          description: City name to search for
          schema:
            type: string
            minLength: 2
            maxLength: 100
            example: "Buenos Aires"
        - name: countryCode
          in: path
          required: true
          description: Country code (ISO 3166-1 alpha-2)
          schema:
            type: string
            pattern: '^[A-Z]{2}$'
            example: "AR"
      responses:
        '200':
          description: City IDs found successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CityIdsResponse'
              examples:
                buenos_aires_ar:
                  summary: Buenos Aires in Argentina
                  value:
                    searchQuery: "Buenos Aires"
                    countryCode: "AR"
                    limit: 5
                    totalResults: 1
                    cities:
                      - id: 3435910
                        name: "Buenos Aires"
                        state: "Buenos Aires"
                        country: "AR"
                        coordinates: ""
                        displayName: "Buenos Aires, Buenos Aires, AR"
                    source: "local_database"
                    databaseInfo:
                      description: "Local database of OpenWeather city IDs organized by city name and country"
                      version: "1.0.0"
                      lastUpdated: "2024-01-15"
                      totalCities: 150
                      source: "OpenWeather Geocoding API"
                london_gb:
                  summary: London in United Kingdom
                  value:
                    searchQuery: "London"
                    countryCode: "GB"
                    limit: 5
                    totalResults: 1
                    cities:
                      - id: 2643743
                        name: "London"
                        state: "England"
                        country: "GB"
                        coordinates: ""
                        displayName: "London, England, GB"
                    source: "local_database"
                    databaseInfo:
                      description: "Local database of OpenWeather city IDs organized by city name and country"
                      version: "1.0.0"
                      lastUpdated: "2024-01-15"
                      totalCities: 150
                      source: "OpenWeather Geocoding API"
        '400':
          description: Invalid parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                invalid_country_code:
                  summary: Invalid country code
                  value:
                    message: "Country code must be a valid 2-letter ISO code (e.g., 'AR', 'US', 'BR')"
                missing_city:
                  summary: Missing city name
                  value:
                    message: "City name parameter is required"
        '401':
          description: Invalid API key
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '429':
          description: Rate limit exceeded
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  # Documentation Endpoints
  /docs:
    get:
      tags:
        - Documentation
      summary: Get API documentation
      description: Get Swagger documentation
      operationId: getDocs
      security: []
      responses:
        '200':
          description: API documentation
          content:
            text/html:
              schema:
                type: string

  /swagger-ui:
    get:
      tags:
        - Documentation
      summary: Get Swagger UI
      description: Get interactive Swagger UI interface
      operationId: getSwaggerUI
      security: []
      responses:
        '200':
          description: Swagger UI interface
          content:
            text/html:
              schema:
                type: string

  /openapi.yaml:
    get:
      tags:
        - Documentation
      summary: Get OpenAPI specification
      description: Get OpenAPI YAML specification
      operationId: getOpenAPI
      security: []
      responses:
        '200':
          description: OpenAPI specification
          content:
            application/x-yaml:
              schema:
                type: string

  # Metrics Endpoint
  /metrics:
    get:
      tags:
        - System
      summary: Get system metrics
      description: Get system performance metrics
      operationId: getMetrics
      security: []
      responses:
        '200':
          description: System metrics
          content:
            application/json:
              schema:
                type: object

  # Enhanced Weather Endpoints
  /weather-enhanced/coordinates/{lat}/{lon}:
    get:
      tags:
        - Weather Enhanced
      summary: Get enhanced current weather by coordinates
      description: Retrieve current weather information with additional metrics and analysis using coordinates
      operationId: getEnhancedWeatherByCoordinates
      parameters:
        - name: lat
          in: path
          required: true
          description: Latitude coordinate (-90 to 90)
          schema:
            type: number
            format: float
            minimum: -90
            maximum: 90
            example: -34.6132
        - name: lon
          in: path
          required: true
          description: Longitude coordinate (-180 to 180)
          schema:
            type: number
            format: float
            minimum: -180
            maximum: 180
            example: -58.3772
      responses:
        '200':
          description: Enhanced current weather data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EnhancedWeatherResponse'
              examples:
                buenos_aires_coordinates_enhanced:
                  summary: Buenos Aires coordinates enhanced weather data
                  value:
                    location:
                      name: "Buenos Aires"
                      country: "AR"
                      coordinates:
                        lat: -34.6132
                        lon: -58.3772
                    current:
                      temperature: 28.5
                      feels_like: 30.1
                      humidity: 72
                      pressure: 1010
                      description: "Partly cloudy"
                      icon: "02d"
                    enhanced:
                      analysis:
                        comfortIndex: 8.2
                        uvRisk: "High"
                        visibility: "Excellent"
                      recommendations:
                        clothing: "Light clothing and sunscreen recommended"
                        activities: "Great weather for outdoor activities"
                      alerts:
                        - type: "UV"
                          message: "High UV index - use sunscreen"
                    timestamp: "2024-01-15T10:30:00Z"
                    source: "OpenWeatherMap"
                london_coordinates_enhanced:
                  summary: London coordinates enhanced weather data
                  value:
                    location:
                      name: "London"
                      country: "GB"
                      coordinates:
                        lat: 51.5074
                        lon: -0.1278
                    current:
                      temperature: 15.2
                      feels_like: 14.8
                      humidity: 65
                      pressure: 1013
                      description: "Cloudy"
                      icon: "04d"
                    enhanced:
                      analysis:
                        comfortIndex: 7.5
                        uvRisk: "Moderate"
                        visibility: "Good"
                      recommendations:
                        clothing: "Light jacket recommended"
                        activities: "Indoor activities preferred"
                      alerts:
                        - type: "Weather"
                          message: "Cloudy conditions expected throughout the day"
                    timestamp: "2024-01-15T10:30:00Z"
                    source: "OpenWeatherMap"
                new_york_coordinates_enhanced:
                  summary: New York coordinates enhanced weather data
                  value:
                    location:
                      name: "New York"
                      country: "US"
                      coordinates:
                        lat: 40.7128
                        lon: -74.0060
                    current:
                      temperature: 22.3
                      feels_like: 24.1
                      humidity: 68
                      pressure: 1015
                      description: "Clear sky"
                      icon: "01d"
                    enhanced:
                      analysis:
                        comfortIndex: 8.5
                        uvRisk: "Moderate"
                        visibility: "Excellent"
                      recommendations:
                        clothing: "Light clothing recommended"
                        activities: "Perfect weather for outdoor activities"
                      alerts:
                        - type: "UV"
                          message: "Moderate UV index - use sunscreen if staying outside"
                    timestamp: "2024-01-15T10:30:00Z"
                    source: "OpenWeatherMap"
                tokyo_coordinates_enhanced:
                  summary: Tokyo coordinates enhanced weather data
                  value:
                    location:
                      name: "Tokyo"
                      country: "JP"
                      coordinates:
                        lat: 35.6762
                        lon: 139.6503
                    current:
                      temperature: 18.7
                      feels_like: 19.2
                      humidity: 75
                      pressure: 1008
                      description: "Light rain"
                      icon: "10d"
                    enhanced:
                      analysis:
                        comfortIndex: 6.8
                        uvRisk: "Low"
                        visibility: "Fair"
                      recommendations:
                        clothing: "Rain jacket and umbrella recommended"
                        activities: "Indoor activities preferred due to rain"
                      alerts:
                        - type: "Weather"
                          message: "Light rain expected - carry an umbrella"
                    timestamp: "2024-01-15T10:30:00Z"
                    source: "OpenWeatherMap"
        '400':
          description: Invalid coordinates
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                invalid_coordinates:
                  summary: Invalid coordinates
                  value:
                    message: "Both latitude and longitude parameters are required"
        '401':
          description: Invalid API key
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '429':
          description: Rate limit exceeded
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /weather-enhanced/location/{location}:
    get:
      tags:
        - Weather Enhanced
      summary: Get enhanced current weather by location
      description: Retrieve current weather information with additional metrics and analysis using location
      operationId: getEnhancedWeatherByLocation
      parameters:
        - name: location
          in: path
          required: true
          description: City name (e.g., "London", "Buenos Aires", "New York")
          schema:
            type: string
            minLength: 2
            maxLength: 100
            example: "London"
      responses:
        '200':
          description: Enhanced current weather data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EnhancedWeatherResponse'
              examples:
                london_enhanced:
                  summary: London enhanced weather data
                  value:
                    location:
                      name: "London"
                      country: "GB"
                      coordinates:
                        lat: 51.5074
                        lon: -0.1278
                    current:
                      temperature: 15.2
                      feels_like: 14.8
                      humidity: 65
                      pressure: 1013
                      description: "Cloudy"
                      icon: "04d"
                    enhanced:
                      analysis:
                        comfortIndex: 7.5
                        uvRisk: "Moderate"
                        visibility: "Good"
                      recommendations:
                        clothing: "Light jacket recommended"
                        activities: "Indoor activities preferred"
                      alerts:
                        - type: "Weather"
                          message: "Cloudy conditions expected throughout the day"
                    timestamp: "2024-01-15T10:30:00Z"
                    source: "OpenWeatherMap"
                buenos_aires_enhanced:
                  summary: Buenos Aires enhanced weather data
                  value:
                    location:
                      name: "Buenos Aires"
                      country: "AR"
                      coordinates:
                        lat: -34.6132
                        lon: -58.3772
                    current:
                      temperature: 28.5
                      feels_like: 30.1
                      humidity: 72
                      pressure: 1010
                      description: "Partly cloudy"
                      icon: "02d"
                    enhanced:
                      analysis:
                        comfortIndex: 8.2
                        uvRisk: "High"
                        visibility: "Excellent"
                      recommendations:
                        clothing: "Light clothing and sunscreen recommended"
                        activities: "Great weather for outdoor activities"
                      alerts:
                        - type: "UV"
                          message: "High UV index - use sunscreen"
                    timestamp: "2024-01-15T10:30:00Z"
                    source: "OpenWeatherMap"
        '400':
          description: Invalid location format
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                invalid_location:
                  summary: Invalid location parameter
                  value:
                    message: "Location parameter is required"
        '401':
          description: Invalid API key
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Location not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '429':
          description: Rate limit exceeded
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /weather-enhanced/zipcode/{zipcode}/{countryCode}:
    get:
      tags:
        - Weather Enhanced
      summary: Get enhanced current weather by zipcode
      description: Retrieve current weather information with additional metrics and analysis using zipcode
      operationId: getEnhancedWeatherByZipcode
      parameters:
        - name: zipcode
          in: path
          required: true
          description: Zipcode
          schema:
            type: string
            pattern: '^[A-Za-z0-9\s\-\.\,]+$'
            example: "10001"
        - name: countryCode
          in: path
          required: true
          description: Country code (ISO 3166-1 alpha-2)
          schema:
            type: string
            pattern: '^[A-Z]{2}$'
            example: "US"
      responses:
        '200':
          description: Enhanced current weather data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EnhancedWeatherResponse'
              examples:
                new_york_zipcode_enhanced:
                  summary: New York enhanced weather data by zipcode
                  value:
                    location:
                      name: "New York"
                      country: "US"
                      coordinates:
                        lat: 40.7128
                        lon: -74.0060
                    current:
                      temperature: 22.3
                      feels_like: 24.1
                      humidity: 68
                      pressure: 1015
                      description: "Clear sky"
                      icon: "01d"
                    enhanced:
                      analysis:
                        comfortIndex: 8.5
                        uvRisk: "Moderate"
                        visibility: "Excellent"
                      recommendations:
                        clothing: "Light clothing recommended"
                        activities: "Perfect weather for outdoor activities"
                      alerts:
                        - type: "UV"
                          message: "Moderate UV index - use sunscreen if staying outside"
                    timestamp: "2024-01-15T10:30:00Z"
                    source: "OpenWeatherMap"
                buenos_aires_zipcode_enhanced:
                  summary: Buenos Aires enhanced weather data by zipcode
                  value:
                    location:
                      name: "Buenos Aires"
                      country: "AR"
                      coordinates:
                        lat: -34.6132
                        lon: -58.3772
                    current:
                      temperature: 28.5
                      feels_like: 30.1
                      humidity: 72
                      pressure: 1010
                      description: "Partly cloudy"
                      icon: "02d"
                    enhanced:
                      analysis:
                        comfortIndex: 8.2
                        uvRisk: "High"
                        visibility: "Excellent"
                      recommendations:
                        clothing: "Light clothing and sunscreen recommended"
                        activities: "Great weather for outdoor activities"
                      alerts:
                        - type: "UV"
                          message: "High UV index - use sunscreen"
                    timestamp: "2024-01-15T10:30:00Z"
                    source: "OpenWeatherMap"
        '400':
          description: Invalid zipcode or country code
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                invalid_zipcode:
                  summary: Invalid zipcode format
                  value:
                    message: "Invalid zipcode format. Please provide a valid zipcode (2-20 characters, letters, numbers, spaces, hyphens, dots, and commas allowed)"
                missing_country_code:
                  summary: Missing country code
                  value:
                    message: "Country code parameter is required"
        '401':
          description: Invalid API key
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Zipcode not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '429':
          description: Rate limit exceeded
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /weather-enhanced/id/{cityId}:
    get:
      tags:
        - Weather Enhanced
      summary: Get enhanced current weather by city ID
      description: Retrieve current weather information with additional metrics and analysis
      operationId: getEnhancedWeatherById
      parameters:
        - name: cityId
          in: path
          required: true
          description: OpenWeatherMap city ID
          schema:
            type: integer
            minimum: 1
            example: 2643743
      responses:
        '200':
          description: Enhanced current weather data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EnhancedWeatherResponse'
              examples:
                london_enhanced:
                  summary: London enhanced weather data by ID
                  value:
                    location:
                      name: "London"
                      country: "GB"
                      coordinates:
                        lat: 51.5074
                        lon: -0.1278
                    current:
                      temperature: 15.2
                      feels_like: 14.8
                      humidity: 65
                      pressure: 1013
                      description: "Cloudy"
                      icon: "04d"
                    enhanced:
                      analysis:
                        comfortIndex: 7.5
                        uvRisk: "Moderate"
                        visibility: "Good"
                      recommendations:
                        clothing: "Light jacket recommended"
                        activities: "Indoor activities preferred"
                      alerts:
                        - type: "Weather"
                          message: "Cloudy conditions expected throughout the day"
                    timestamp: "2024-01-15T10:30:00Z"
                    source: "OpenWeatherMap"
                buenos_aires_enhanced:
                  summary: Buenos Aires enhanced weather data by ID
                  value:
                    location:
                      name: "Buenos Aires"
                      country: "AR"
                      coordinates:
                        lat: -34.6132
                        lon: -58.3772
                    current:
                      temperature: 28.5
                      feels_like: 30.1
                      humidity: 72
                      pressure: 1010
                      description: "Partly cloudy"
                      icon: "02d"
                    enhanced:
                      analysis:
                        comfortIndex: 8.2
                        uvRisk: "High"
                        visibility: "Excellent"
                      recommendations:
                        clothing: "Light clothing and sunscreen recommended"
                        activities: "Great weather for outdoor activities"
                      alerts:
                        - type: "UV"
                          message: "High UV index - use sunscreen"
                    timestamp: "2024-01-15T10:30:00Z"
                    source: "OpenWeatherMap"
        '400':
          description: Invalid city ID
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                invalid_city_id:
                  summary: Invalid city ID
                  value:
                    message: "City ID parameter is required"
        '401':
          description: Invalid API key
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: City not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '429':
          description: Rate limit exceeded
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /weather-enhanced/combined/{location}/{units}/{language}:
    get:
      tags:
        - Weather Enhanced
      summary: Get enhanced current weather with all parameters combined
      description: Retrieve enhanced current weather information with specific units and language, including additional analysis
      operationId: getEnhancedWeatherByCombined
      parameters:
        - name: location
          in: path
          required: true
          description: City name (e.g., "Buenos Aires", "London", "Tokyo")
          schema:
            type: string
            minLength: 2
            maxLength: 100
            example: "Buenos Aires"
        - name: units
          in: path
          required: true
          description: Temperature units
          schema:
            type: string
            enum: [metric, imperial, kelvin]
            example: "Kelvin"
        - name: language
          in: path
          required: true
          description: Language code for weather descriptions
          schema:
            type: string
            enum: [en, es, fr, de, it, pt, ru, ja, ko, zh_cn, zh_tw, ar, hi, th, tr, vi]
            example: "fr"
      responses:
        '200':
          description: Enhanced current weather data with specific units and language
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EnhancedWeatherResponse'
              examples:
                buenos_aires_kelvin_french_enhanced:
                  summary: Buenos Aires enhanced weather data in Kelvin with French descriptions
                  value:
                    location:
                      name: "Buenos Aires"
                      country: "AR"
                      coordinates:
                        lat: -34.6132
                        lon: -58.3772
                    current:
                      temperature: 301.5
                      feels_like: 303.1
                      humidity: 72
                      pressure: 1010
                      description: "Partiellement nuageux"
                      icon: "02d"
                    enhanced:
                      analysis:
                        comfortIndex: 8.2
                        uvRisk: "High"
                        visibility: "Excellent"
                      recommendations:
                        clothing: "Light clothing and sunscreen recommended"
                        activities: "Great weather for outdoor activities"
                      alerts:
                        - type: "UV"
                          message: "High UV index - use sunscreen"
                    timestamp: "2024-01-15T10:30:00Z"
                    source: "OpenWeatherMap"
                tokyo_metric_spanish_enhanced:
                  summary: Tokyo enhanced weather data in metric units with Spanish descriptions
                  value:
                    location:
                      name: "Tokyo"
                      country: "JP"
                      coordinates:
                        lat: 35.6762
                        lon: 139.6503
                    current:
                      temperature: 18.7
                      feels_like: 19.2
                      humidity: 75
                      pressure: 1008
                      description: "Lluvia ligera"
                      icon: "10d"
                    enhanced:
                      analysis:
                        comfortIndex: 6.8
                        uvRisk: "Low"
                        visibility: "Fair"
                      recommendations:
                        clothing: "Rain jacket and umbrella recommended"
                        activities: "Indoor activities preferred due to rain"
                      alerts:
                        - type: "Weather"
                          message: "Light rain expected - carry an umbrella"
                    timestamp: "2024-01-15T10:30:00Z"
                    source: "OpenWeatherMap"
        '400':
          description: Invalid parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                invalid_location:
                  summary: Invalid location parameter
                  value:
                    message: "Location parameter is required"
                invalid_units:
                  summary: Invalid units parameter
                  value:
                    message: "Invalid units parameter. Must be one of: metric, imperial, kelvin"
                invalid_language:
                  summary: Invalid language parameter
                  value:
                    message: "Invalid language parameter. Must be one of: en, es, fr, de, it, pt, ru, ja, ko, zh_cn, zh_tw, ar, hi, th, tr, vi"
        '401':
          description: Invalid API key
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Location not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '429':
          description: Rate limit exceeded
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /forecast/days/{days}/enhanced:
    get:
      tags:
        - Forecast Enhanced
      summary: Get enhanced weather forecast by days
      description: Retrieve weather forecast with additional analysis and insights
      operationId: getEnhancedForecastByDays
      parameters:
        - name: days
          in: path
          required: true
          description: Number of forecast days (1-5)
          schema:
            type: integer
            minimum: 1
            maximum: 5
            example: 5
        - name: q
          in: query
          required: true
          description: City name and country code (e.g., "London,GB")
          schema:
            type: string
            pattern: '^[a-zA-Z\s]+,[A-Z]{2}$'
            example: "London,GB"
        - name: units
          in: query
          description: Temperature units
          schema:
            type: string
            enum: [metric, imperial, kelvin]
            default: metric
        - name: lang
          in: query
          description: Language for weather descriptions
          schema:
            type: string
            enum: [en, es, fr, de, it, pt, ru, zh, ja, ko]
            default: en
      responses:
        '200':
          description: Enhanced weather forecast data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EnhancedForecastResponse'
        '400':
          description: Invalid parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Invalid API key
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Location not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '429':
          description: Rate limit exceeded
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  # Additional Forecast Endpoints
  /forecast/compare:
    get:
      tags:
        - Forecast
      summary: Get weather forecast comparison
      description: Compare weather forecast data between different locations or time periods
      operationId: getForecastByCompare
      responses:
        '200':
          description: Weather forecast comparison data
          content:
            application/json:
              schema:
                type: object
        '400':
          description: Invalid parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /forecast/compare/enhanced:
    get:
      tags:
        - Forecast Enhanced
      summary: Get enhanced weather forecast comparison
      description: Enhanced comparison of weather forecast data
      operationId: getEnhancedForecastByCompare
      responses:
        '200':
          description: Enhanced weather forecast comparison data
          content:
            application/json:
              schema:
                type: object
        '400':
          description: Invalid parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /forecast/events:
    get:
      tags:
        - Forecast
      summary: Get weather forecast events
      description: Get weather events and alerts forecast
      operationId: getForecastByEvents
      responses:
        '200':
          description: Weather events forecast data
          content:
            application/json:
              schema:
                type: object
        '400':
          description: Invalid parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /forecast/events/enhanced:
    get:
      tags:
        - Forecast Enhanced
      summary: Get enhanced weather forecast events
      description: Enhanced weather events and alerts forecast
      operationId: getEnhancedForecastByEvents
      responses:
        '200':
          description: Enhanced weather events forecast data
          content:
            application/json:
              schema:
                type: object
        '400':
          description: Invalid parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /forecast/hourly:
    get:
      tags:
        - Forecast
      summary: Get hourly weather forecast
      description: Get detailed hourly weather forecast
      operationId: getForecastByHourly
      responses:
        '200':
          description: Hourly weather forecast data
          content:
            application/json:
              schema:
                type: object
        '400':
          description: Invalid parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /forecast/hourly/enhanced:
    get:
      tags:
        - Forecast Enhanced
      summary: Get enhanced hourly weather forecast
      description: Enhanced detailed hourly weather forecast
      operationId: getEnhancedForecastByHourly
      responses:
        '200':
          description: Enhanced hourly weather forecast data
          content:
            application/json:
              schema:
                type: object
        '400':
          description: Invalid parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /forecast/interval:
    get:
      tags:
        - Forecast
      summary: Get weather forecast by interval
      description: Get weather forecast for specific time intervals
      operationId: getForecastByInterval
      responses:
        '200':
          description: Interval weather forecast data
          content:
            application/json:
              schema:
                type: object
        '400':
          description: Invalid parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /forecast/interval/enhanced:
    get:
      tags:
        - Forecast Enhanced
      summary: Get enhanced weather forecast by interval
      description: Enhanced weather forecast for specific time intervals
      operationId: getEnhancedForecastByInterval
      responses:
        '200':
          description: Enhanced interval weather forecast data
          content:
            application/json:
              schema:
                type: object
        '400':
          description: Invalid parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /forecast/weekly:
    get:
      tags:
        - Forecast
      summary: Get weekly weather forecast
      description: Get weekly weather forecast overview
      operationId: getForecastByWeekly
      responses:
        '200':
          description: Weekly weather forecast data
          content:
            application/json:
              schema:
                type: object
        '400':
          description: Invalid parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /forecast/weekly/enhanced:
    get:
      tags:
        - Forecast Enhanced
      summary: Get enhanced weekly weather forecast
      description: Enhanced weekly weather forecast overview
      operationId: getEnhancedForecastByWeekly
      responses:
        '200':
          description: Enhanced weekly weather forecast data
          content:
            application/json:
              schema:
                type: object
        '400':
          description: Invalid parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

components:
  securitySchemes:
    ApiKeyAuth:
      type: apiKey
      in: header
      name: X-API-Key
      description: API key for authentication
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: JWT token for authentication

  schemas:
    # Base Schemas
    WeatherResponse:
      type: object
      required:
        - location
        - current
        - timestamp
      properties:
        location:
          $ref: '#/components/schemas/Location'
        current:
          $ref: '#/components/schemas/CurrentWeather'
        timestamp:
          type: string
          format: date-time
          description: Response timestamp
        source:
          type: string
          description: Data source
          example: "OpenWeatherMap"

    EnhancedWeatherResponse:
      type: object
      required:
        - location
        - current
        - enhanced
        - timestamp
      properties:
        location:
          $ref: '#/components/schemas/Location'
        current:
          $ref: '#/components/schemas/CurrentWeather'
        enhanced:
          $ref: '#/components/schemas/EnhancedData'
        timestamp:
          type: string
          format: date-time
          description: Response timestamp
        source:
          type: string
          description: Data source
          example: "OpenWeatherMap"

    ForecastResponse:
      type: object
      required:
        - location
        - forecast
        - timestamp
      properties:
        location:
          $ref: '#/components/schemas/Location'
        forecast:
          type: array
          items:
            $ref: '#/components/schemas/ForecastDay'
        timestamp:
          type: string
          format: date-time
          description: Response timestamp
        source:
          type: string
          description: Data source
          example: "OpenWeatherMap"

    EnhancedForecastResponse:
      type: object
      required:
        - location
        - forecast
        - enhanced
        - timestamp
      properties:
        location:
          $ref: '#/components/schemas/Location'
        forecast:
          type: array
          items:
            $ref: '#/components/schemas/ForecastDay'
        enhanced:
          $ref: '#/components/schemas/EnhancedForecastData'
        timestamp:
          type: string
          format: date-time
          description: Response timestamp
        source:
          type: string
          description: Data source
          example: "OpenWeatherMap"

    CityIdsResponse:
      type: object
      required:
        - searchQuery
        - countryCode
        - limit
        - totalResults
        - cities
        - source
        - databaseInfo
      properties:
        searchQuery:
          type: string
          description: Cleaned search query
          example: "Buenos Aires"
        countryCode:
          type: string
          description: Country code filter (empty if not specified)
          example: "AR"
        limit:
          type: integer
          description: Maximum results requested
          example: 5
        totalResults:
          type: integer
          description: Total number of matching cities
          example: 1
        cities:
          type: array
          items:
            $ref: '#/components/schemas/CityInfo'
        source:
          type: string
          description: Data source
          example: "local_database"
        databaseInfo:
          type: object
          required:
            - description
            - version
            - lastUpdated
            - totalCities
            - source
          properties:
            description:
              type: string
              example: "Local database of OpenWeather city IDs organized by city name and country"
            version:
              type: string
              example: "1.0.0"
            lastUpdated:
              type: string
              format: date
              example: "2024-01-15"
            totalCities:
              type: integer
              example: 150
            source:
              type: string
              example: "OpenWeather Geocoding API"

    HealthResponse:
      type: object
      required:
        - status
        - timestamp
        - uptime
        - version
      properties:
        status:
          type: string
          enum: [healthy, unhealthy, degraded]
          description: Overall health status
        timestamp:
          type: string
          format: date-time
          description: Health check timestamp
        uptime:
          type: number
          description: Service uptime in seconds
        version:
          type: string
          description: API version
          example: "1.0.0"
        services:
          type: object
          properties:
            database:
              type: string
              enum: [healthy, unhealthy]
            cache:
              type: string
              enum: [healthy, unhealthy]
            externalApi:
              type: string
              enum: [healthy, unhealthy]
        metrics:
          type: object
          properties:
            totalRequests:
              type: integer
            errorRate:
              type: number
              format: float
            averageResponseTime:
              type: number
              format: float

    ErrorResponse:
      type: object
      required:
        - error
        - message
        - timestamp
      properties:
        error:
          type: string
          description: Error type
          example: "VALIDATION_ERROR"
        message:
          type: string
          description: Human-readable error message
          example: "Invalid city ID provided"
        timestamp:
          type: string
          format: date-time
          description: Error timestamp
        details:
          type: object
          description: Additional error details
        requestId:
          type: string
          description: Unique request identifier
          example: "req_123456789"

    # Detailed Schemas
    Location:
      type: object
      required:
        - name
        - country
        - coordinates
      properties:
        name:
          type: string
          description: City name
          example: "London"
        country:
          type: string
          description: Country name
          example: "United Kingdom"
        countryCode:
          type: string
          description: ISO 3166-1 alpha-2 country code
          example: "GB"
        coordinates:
          $ref: '#/components/schemas/Coordinates'
        timezone:
          type: string
          description: Timezone identifier
          example: "Europe/London"
        population:
          type: integer
          description: City population
          example: 8982000

    Coordinates:
      type: object
      required:
        - latitude
        - longitude
      properties:
        latitude:
          type: number
          format: float
          minimum: -90
          maximum: 90
          example: 51.5074
        longitude:
          type: number
          format: float
          minimum: -180
          maximum: 180
          example: -0.1278

    CurrentWeather:
      type: object
      required:
        - temperature
        - feelsLike
        - humidity
        - pressure
        - visibility
        - wind
        - weather
        - timestamp
      properties:
        temperature:
          $ref: '#/components/schemas/Temperature'
        feelsLike:
          $ref: '#/components/schemas/Temperature'
        humidity:
          type: integer
          minimum: 0
          maximum: 100
          description: Humidity percentage
          example: 65
        pressure:
          type: number
          format: float
          description: Atmospheric pressure in hPa
          example: 1013.25
        visibility:
          type: number
          format: float
          description: Visibility in meters
          example: 10000
        wind:
          $ref: '#/components/schemas/Wind'
        weather:
          type: array
          items:
            $ref: '#/components/schemas/WeatherCondition'
        timestamp:
          type: string
          format: date-time
          description: Weather data timestamp

    Temperature:
      type: object
      required:
        - value
        - unit
      properties:
        value:
          type: number
          format: float
          description: Temperature value
          example: 15.5
        unit:
          type: string
          enum: [celsius, fahrenheit, kelvin]
          description: Temperature unit
          example: "celsius"

    Wind:
      type: object
      required:
        - speed
        - direction
      properties:
        speed:
          type: number
          format: float
          description: Wind speed
          example: 3.5
        direction:
          type: integer
          minimum: 0
          maximum: 360
          description: Wind direction in degrees
          example: 180
        gust:
          type: number
          format: float
          description: Wind gust speed
          example: 5.2

    WeatherCondition:
      type: object
      required:
        - id
        - main
        - description
        - icon
      properties:
        id:
          type: integer
          description: Weather condition ID
          example: 800
        main:
          type: string
          description: Main weather condition
          example: "Clear"
        description:
          type: string
          description: Weather condition description
          example: "clear sky"
        icon:
          type: string
          description: Weather icon code
          example: "01d"

    ForecastDay:
      type: object
      required:
        - date
        - temperature
        - weather
        - wind
      properties:
        date:
          type: string
          format: date
          description: Forecast date
          example: "2024-01-15"
        temperature:
          $ref: '#/components/schemas/TemperatureRange'
        weather:
          type: array
          items:
            $ref: '#/components/schemas/WeatherCondition'
        wind:
          $ref: '#/components/schemas/Wind'
        humidity:
          type: integer
          minimum: 0
          maximum: 100
          description: Humidity percentage
          example: 70
        pressure:
          type: number
          format: float
          description: Atmospheric pressure in hPa
          example: 1015.5
        visibility:
          type: number
          format: float
          description: Visibility in meters
          example: 8000

    TemperatureRange:
      type: object
      required:
        - min
        - max
        - unit
      properties:
        min:
          type: number
          format: float
          description: Minimum temperature
          example: 12.0
        max:
          type: number
          format: float
          description: Maximum temperature
          example: 18.5
        unit:
          type: string
          enum: [celsius, fahrenheit, kelvin]
          description: Temperature unit
          example: "celsius"

    City:
      type: object
      required:
        - id
        - name
        - country
        - coordinates
      properties:
        id:
          type: integer
          description: OpenWeatherMap city ID
          example: 2643743
        name:
          type: string
          description: City name
          example: "London"
        country:
          type: string
          description: Country name
          example: "United Kingdom"
        countryCode:
          type: string
          description: ISO 3166-1 alpha-2 country code
          example: "GB"
        coordinates:
          $ref: '#/components/schemas/Coordinates'
        state:
          type: string
          description: State or province
          example: "England"

    CityInfo:
      type: object
      required:
        - id
        - name
        - state
        - country
        - coordinates
        - displayName
      properties:
        id:
          type: integer
          description: OpenWeatherMap city ID
          example: 3435910
        name:
          type: string
          description: City name
          example: "Buenos Aires"
        state:
          type: string
          description: State or province
          example: "Buenos Aires"
        country:
          type: string
          description: ISO 3166-1 alpha-2 country code
          example: "AR"
        coordinates:
          type: string
          description: Coordinates (may be empty in local database)
          example: ""
        displayName:
          type: string
          description: Full display name with location hierarchy
          example: "Buenos Aires, Buenos Aires, AR"

    EnhancedData:
      type: object
      required:
        - analysis
        - recommendations
        - alerts
      properties:
        analysis:
          type: object
          properties:
            comfortIndex:
              type: number
              format: float
              minimum: 0
              maximum: 10
              description: Comfort index (0-10)
              example: 7.5
            uvIndex:
              type: number
              format: float
              minimum: 0
              maximum: 11
              description: UV index
              example: 3.2
            airQuality:
              type: string
              enum: [excellent, good, moderate, poor, very_poor, hazardous]
              description: Air quality rating
              example: "good"
        recommendations:
          type: array
          items:
            type: string
          description: Weather-based recommendations
          example: ["Perfect weather for outdoor activities", "Consider light clothing"]
        alerts:
          type: array
          items:
            $ref: '#/components/schemas/WeatherAlert'
          description: Weather alerts and warnings

    EnhancedForecastData:
      type: object
      required:
        - summary
        - trends
        - recommendations
      properties:
        summary:
          type: object
          properties:
            overallTrend:
              type: string
              enum: [improving, stable, deteriorating]
              description: Overall weather trend
              example: "stable"
            averageTemperature:
              type: number
              format: float
              description: Average temperature over forecast period
              example: 16.2
            precipitationChance:
              type: number
              format: float
              minimum: 0
              maximum: 100
              description: Average precipitation chance
              example: 25.5
        trends:
          type: object
          properties:
            temperature:
              type: string
              enum: [rising, stable, falling]
              description: Temperature trend
              example: "stable"
            humidity:
              type: string
              enum: [rising, stable, falling]
              description: Humidity trend
              example: "rising"
            wind:
              type: string
              enum: [increasing, stable, decreasing]
              description: Wind trend
              example: "stable"
        recommendations:
          type: array
          items:
            type: string
          description: Forecast-based recommendations
          example: ["Great week for outdoor activities", "Consider umbrella for weekend"]

    WeatherAlert:
      type: object
      required:
        - type
        - severity
        - message
        - validFrom
        - validTo
      properties:
        type:
          type: string
          enum: [weather_warning, weather_watch, weather_advisory]
          description: Alert type
          example: "weather_warning"
        severity:
          type: string
          enum: [low, moderate, high, extreme]
          description: Alert severity
          example: "moderate"
        message:
          type: string
          description: Alert message
          example: "Heavy rain expected in the afternoon"
        validFrom:
          type: string
          format: date-time
          description: Alert valid from
        validTo:
          type: string
          format: date-time
          description: Alert valid until

tags:
  - name: System
    description: System health and status endpoints
  - name: Weather
    description: Current weather data endpoints
  - name: Weather Enhanced
    description: Enhanced current weather data with additional analysis
  - name: Forecast
    description: Weather forecast endpoints
  - name: Forecast Enhanced
    description: Enhanced weather forecast with additional insights
  - name: Information
    description: City and location information endpoints
  - name: Documentation
    description: API documentation and specification endpoints
